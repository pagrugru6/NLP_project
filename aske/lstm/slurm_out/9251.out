
=== RUNNING rnn =============

0
training for language fi
Model loaded from ../checkpoints/bpe/bpe_model_fi_20000.pkl
Epoch 1/2
  0%|          | 0/67 [00:00<?, ?it/s]  1%|▏         | 1/67 [00:08<09:06,  8.28s/it]  3%|▎         | 2/67 [00:15<08:28,  7.83s/it]  4%|▍         | 3/67 [00:24<08:41,  8.14s/it]  6%|▌         | 4/67 [00:33<08:46,  8.36s/it]  7%|▋         | 5/67 [00:43<09:19,  9.02s/it]  9%|▉         | 6/67 [00:52<09:08,  8.99s/it] 10%|█         | 7/67 [00:59<08:23,  8.39s/it] 12%|█▏        | 8/67 [01:08<08:24,  8.56s/it] 13%|█▎        | 9/67 [01:15<07:55,  8.20s/it] 15%|█▍        | 10/67 [01:22<07:33,  7.95s/it] 16%|█▋        | 11/67 [01:31<07:31,  8.06s/it] 18%|█▊        | 12/67 [01:38<07:10,  7.82s/it] 19%|█▉        | 13/67 [01:47<07:25,  8.25s/it] 21%|██        | 14/67 [01:55<07:04,  8.01s/it] 22%|██▏       | 15/67 [02:02<06:50,  7.89s/it] 24%|██▍       | 16/67 [02:11<06:50,  8.05s/it] 25%|██▌       | 17/67 [02:19<06:42,  8.05s/it] 27%|██▋       | 18/67 [02:27<06:30,  7.96s/it] 28%|██▊       | 19/67 [02:34<06:09,  7.69s/it] 30%|██▉       | 20/67 [02:43<06:23,  8.15s/it] 31%|███▏      | 21/67 [02:51<06:18,  8.22s/it] 33%|███▎      | 22/67 [02:59<06:04,  8.11s/it] 34%|███▍      | 23/67 [03:05<05:31,  7.54s/it] 36%|███▌      | 24/67 [03:13<05:19,  7.42s/it] 37%|███▋      | 25/67 [03:20<05:14,  7.48s/it] 39%|███▉      | 26/67 [03:28<05:16,  7.71s/it] 40%|████      | 27/67 [03:37<05:18,  7.96s/it] 42%|████▏     | 28/67 [03:46<05:25,  8.34s/it] 43%|████▎     | 29/67 [03:54<05:06,  8.08s/it] 45%|████▍     | 30/67 [04:01<04:49,  7.82s/it] 46%|████▋     | 31/67 [04:09<04:47,  7.99s/it] 48%|████▊     | 32/67 [04:15<04:21,  7.47s/it] 49%|████▉     | 33/67 [04:22<04:08,  7.31s/it] 51%|█████     | 34/67 [04:30<04:04,  7.40s/it] 52%|█████▏    | 35/67 [04:38<04:05,  7.68s/it] 54%|█████▎    | 36/67 [04:49<04:25,  8.56s/it] 55%|█████▌    | 37/67 [04:57<04:13,  8.44s/it] 57%|█████▋    | 38/67 [05:05<03:57,  8.20s/it] 58%|█████▊    | 39/67 [05:12<03:43,  7.97s/it] 60%|█████▉    | 40/67 [05:21<03:40,  8.15s/it] 61%|██████    | 41/67 [05:30<03:37,  8.36s/it] 63%|██████▎   | 42/67 [05:39<03:34,  8.56s/it] 64%|██████▍   | 43/67 [05:46<03:16,  8.20s/it] 66%|██████▌   | 44/67 [05:52<02:53,  7.56s/it] 67%|██████▋   | 45/67 [06:00<02:48,  7.67s/it] 69%|██████▊   | 46/67 [06:08<02:44,  7.83s/it] 70%|███████   | 47/67 [06:16<02:37,  7.85s/it] 72%|███████▏  | 48/67 [06:23<02:23,  7.55s/it] 73%|███████▎  | 49/67 [06:29<02:09,  7.19s/it] 75%|███████▍  | 50/67 [06:38<02:09,  7.63s/it] 76%|███████▌  | 51/67 [06:46<02:02,  7.63s/it] 78%|███████▊  | 52/67 [06:53<01:54,  7.60s/it] 79%|███████▉  | 53/67 [07:01<01:46,  7.63s/it] 81%|████████  | 54/67 [07:09<01:41,  7.79s/it] 82%|████████▏ | 55/67 [07:18<01:36,  8.05s/it] 84%|████████▎ | 56/67 [07:25<01:24,  7.69s/it] 85%|████████▌ | 57/67 [07:32<01:15,  7.54s/it] 87%|████████▋ | 58/67 [07:40<01:08,  7.67s/it] 88%|████████▊ | 59/67 [07:49<01:05,  8.17s/it] 90%|████████▉ | 60/67 [07:57<00:57,  8.17s/it] 91%|█████████ | 61/67 [08:05<00:47,  7.99s/it] 93%|█████████▎| 62/67 [08:14<00:41,  8.24s/it] 94%|█████████▍| 63/67 [08:22<00:33,  8.39s/it] 96%|█████████▌| 64/67 [08:30<00:24,  8.09s/it] 97%|█████████▋| 65/67 [08:38<00:16,  8.02s/it] 99%|█████████▊| 66/67 [08:45<00:07,  7.98s/it]100%|██████████| 67/67 [08:49<00:00,  6.70s/it]100%|██████████| 67/67 [08:49<00:00,  7.91s/it]
train_loss=0.3952914738833015
Epoch 2/2
  0%|          | 0/67 [00:00<?, ?it/s]  1%|▏         | 1/67 [00:06<07:29,  6.81s/it]  3%|▎         | 2/67 [00:14<07:58,  7.36s/it]  4%|▍         | 3/67 [00:22<07:57,  7.45s/it]  6%|▌         | 4/67 [00:31<08:35,  8.18s/it]  7%|▋         | 5/67 [00:39<08:29,  8.22s/it]  9%|▉         | 6/67 [00:47<08:11,  8.06s/it] 10%|█         | 7/67 [00:55<07:55,  7.93s/it] 12%|█▏        | 8/67 [01:03<08:03,  8.20s/it] 13%|█▎        | 9/67 [01:11<07:36,  7.87s/it] 15%|█▍        | 10/67 [01:19<07:36,  8.01s/it] 16%|█▋        | 11/67 [01:25<07:00,  7.50s/it] 18%|█▊        | 12/67 [01:33<06:55,  7.56s/it] 19%|█▉        | 13/67 [01:39<06:31,  7.25s/it] 21%|██        | 14/67 [01:47<06:23,  7.24s/it] 22%|██▏       | 15/67 [01:55<06:27,  7.46s/it] 24%|██▍       | 16/67 [02:01<06:03,  7.12s/it] 25%|██▌       | 17/67 [02:09<06:16,  7.53s/it] 27%|██▋       | 18/67 [02:19<06:35,  8.08s/it] 28%|██▊       | 19/67 [02:28<06:41,  8.36s/it] 30%|██▉       | 20/67 [02:35<06:18,  8.05s/it] 31%|███▏      | 21/67 [02:42<05:59,  7.82s/it] 33%|███▎      | 22/67 [02:50<05:47,  7.72s/it] 34%|███▍      | 23/67 [03:00<06:05,  8.30s/it] 36%|███▌      | 24/67 [03:07<05:41,  7.93s/it] 37%|███▋      | 25/67 [03:15<05:34,  7.95s/it] 39%|███▉      | 26/67 [03:23<05:34,  8.16s/it] 40%|████      | 27/67 [03:32<05:34,  8.36s/it] 42%|████▏     | 28/67 [03:38<04:59,  7.69s/it] 43%|████▎     | 29/67 [03:46<04:50,  7.66s/it] 45%|████▍     | 30/67 [03:54<04:46,  7.75s/it] 46%|████▋     | 31/67 [04:03<04:54,  8.18s/it] 48%|████▊     | 32/67 [04:11<04:43,  8.09s/it] 49%|████▉     | 33/67 [04:20<04:44,  8.37s/it] 51%|█████     | 34/67 [04:28<04:30,  8.18s/it] 52%|█████▏    | 35/67 [04:35<04:14,  7.94s/it] 54%|█████▎    | 36/67 [04:43<04:03,  7.86s/it] 55%|█████▌    | 37/67 [04:52<04:05,  8.18s/it] 57%|█████▋    | 38/67 [05:02<04:18,  8.93s/it] 58%|█████▊    | 39/67 [05:11<04:04,  8.75s/it] 60%|█████▉    | 40/67 [05:19<03:54,  8.70s/it] 61%|██████    | 41/67 [05:28<03:45,  8.67s/it] 63%|██████▎   | 42/67 [05:34<03:15,  7.83s/it] 64%|██████▍   | 43/67 [05:40<03:00,  7.51s/it] 66%|██████▌   | 44/67 [05:49<03:01,  7.90s/it] 67%|██████▋   | 45/67 [05:57<02:52,  7.83s/it] 69%|██████▊   | 46/67 [06:05<02:44,  7.84s/it] 70%|███████   | 47/67 [06:13<02:37,  7.87s/it] 72%|███████▏  | 48/67 [06:21<02:34,  8.13s/it] 73%|███████▎  | 49/67 [06:29<02:22,  7.92s/it] 75%|███████▍  | 50/67 [06:37<02:14,  7.89s/it] 76%|███████▌  | 51/67 [06:46<02:12,  8.26s/it] 78%|███████▊  | 52/67 [06:53<02:00,  8.03s/it] 79%|███████▉  | 53/67 [07:03<01:58,  8.45s/it] 81%|████████  | 54/67 [07:12<01:54,  8.77s/it] 82%|████████▏ | 55/67 [07:20<01:43,  8.58s/it] 84%|████████▎ | 56/67 [07:28<01:30,  8.24s/it] 85%|████████▌ | 57/67 [07:36<01:22,  8.23s/it] 87%|████████▋ | 58/67 [07:42<01:08,  7.65s/it] 88%|████████▊ | 59/67 [07:51<01:03,  7.97s/it] 90%|████████▉ | 60/67 [07:59<00:55,  7.98s/it] 91%|█████████ | 61/67 [08:06<00:46,  7.80s/it] 93%|█████████▎| 62/67 [08:14<00:38,  7.66s/it] 94%|█████████▍| 63/67 [08:21<00:30,  7.66s/it] 96%|█████████▌| 64/67 [08:28<00:22,  7.37s/it] 97%|█████████▋| 65/67 [08:37<00:15,  7.71s/it] 99%|█████████▊| 66/67 [08:45<00:07,  7.84s/it]100%|██████████| 67/67 [08:48<00:00,  6.51s/it]100%|██████████| 67/67 [08:48<00:00,  7.89s/it]
train_loss=0.37548576695705527
F1 Score: 0.8370044052863436
P score: 0.7196969696969697
R score: 1.0
Traceback (most recent call last):
  File "/home/hlp179/nlp/aske/lstm/runscripts/run_lstm.py", line 55, in <module>
    validate(model, val_loader, criterion, device)
  File "/home/hlp179/nlp/aske/lstm/runscripts/../model/lstm.py", line 64, in validate
    print(f"Confusion matrix: {confusion_matrix(true_labels, predicitons)}")
                                                             ^^^^^^^^^^^
NameError: name 'predicitons' is not defined. Did you mean: 'predictions'?
... done <3
