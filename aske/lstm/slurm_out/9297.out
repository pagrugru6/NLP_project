
=== RUNNING rnn =============

0
training for language fi
Model loaded from ../checkpoints/bpe/bpe_model_fi_20000.pkl
Epoch 1/2
  0%|          | 0/67 [00:00<?, ?it/s]  1%|▏         | 1/67 [00:07<08:13,  7.48s/it]  3%|▎         | 2/67 [00:16<08:55,  8.24s/it]  4%|▍         | 3/67 [00:23<08:16,  7.76s/it]  6%|▌         | 4/67 [00:30<07:50,  7.47s/it]  7%|▋         | 5/67 [00:37<07:42,  7.46s/it]  9%|▉         | 6/67 [00:46<08:01,  7.90s/it] 10%|█         | 7/67 [00:54<07:53,  7.90s/it] 12%|█▏        | 8/67 [01:02<07:48,  7.95s/it] 13%|█▎        | 9/67 [01:09<07:30,  7.76s/it] 15%|█▍        | 10/67 [01:17<07:17,  7.67s/it] 16%|█▋        | 11/67 [01:25<07:24,  7.95s/it] 18%|█▊        | 12/67 [01:32<06:59,  7.63s/it] 19%|█▉        | 13/67 [01:41<07:11,  7.99s/it] 21%|██        | 14/67 [01:49<06:54,  7.81s/it] 22%|██▏       | 15/67 [01:55<06:29,  7.49s/it] 24%|██▍       | 16/67 [02:04<06:33,  7.71s/it] 25%|██▌       | 17/67 [02:12<06:37,  7.96s/it] 27%|██▋       | 18/67 [02:19<06:15,  7.66s/it] 28%|██▊       | 19/67 [02:29<06:39,  8.32s/it] 30%|██▉       | 20/67 [02:38<06:41,  8.55s/it] 31%|███▏      | 21/67 [02:45<06:08,  8.01s/it] 33%|███▎      | 22/67 [02:53<05:59,  8.00s/it] 34%|███▍      | 23/67 [02:58<05:20,  7.30s/it] 36%|███▌      | 24/67 [03:08<05:39,  7.89s/it] 37%|███▋      | 25/67 [03:15<05:23,  7.70s/it] 39%|███▉      | 26/67 [03:22<05:02,  7.37s/it] 40%|████      | 27/67 [03:30<05:06,  7.67s/it] 42%|████▏     | 28/67 [03:38<05:03,  7.78s/it] 43%|████▎     | 29/67 [03:45<04:48,  7.59s/it] 45%|████▍     | 30/67 [03:56<05:12,  8.46s/it] 46%|████▋     | 31/67 [04:03<04:48,  8.00s/it] 48%|████▊     | 32/67 [04:11<04:43,  8.11s/it] 49%|████▉     | 33/67 [04:19<04:32,  8.02s/it] 51%|█████     | 34/67 [04:27<04:24,  8.03s/it] 52%|█████▏    | 35/67 [04:34<04:08,  7.75s/it] 54%|█████▎    | 36/67 [04:42<03:59,  7.73s/it] 55%|█████▌    | 37/67 [04:49<03:49,  7.65s/it] 57%|█████▋    | 38/67 [04:58<03:55,  8.12s/it] 58%|█████▊    | 39/67 [05:07<03:55,  8.40s/it] 60%|█████▉    | 40/67 [05:16<03:45,  8.37s/it] 61%|██████    | 41/67 [05:24<03:39,  8.44s/it] 63%|██████▎   | 42/67 [05:32<03:23,  8.14s/it] 64%|██████▍   | 43/67 [05:39<03:07,  7.80s/it] 66%|██████▌   | 44/67 [05:46<02:55,  7.65s/it] 67%|██████▋   | 45/67 [05:54<02:48,  7.65s/it] 69%|██████▊   | 46/67 [06:01<02:41,  7.69s/it] 70%|███████   | 47/67 [06:09<02:32,  7.61s/it] 72%|███████▏  | 48/67 [06:16<02:23,  7.53s/it] 73%|███████▎  | 49/67 [06:24<02:19,  7.74s/it] 75%|███████▍  | 50/67 [06:32<02:13,  7.83s/it] 76%|███████▌  | 51/67 [06:41<02:07,  7.95s/it] 78%|███████▊  | 52/67 [06:49<02:00,  8.04s/it] 79%|███████▉  | 53/67 [06:58<01:56,  8.29s/it] 81%|████████  | 54/67 [07:07<01:50,  8.49s/it] 82%|████████▏ | 55/67 [07:14<01:38,  8.22s/it] 84%|████████▎ | 56/67 [07:22<01:29,  8.18s/it] 85%|████████▌ | 57/67 [07:30<01:21,  8.14s/it] 87%|████████▋ | 58/67 [07:39<01:14,  8.27s/it] 88%|████████▊ | 59/67 [07:48<01:06,  8.36s/it] 90%|████████▉ | 60/67 [07:55<00:57,  8.18s/it] 91%|█████████ | 61/67 [08:03<00:48,  8.14s/it] 93%|█████████▎| 62/67 [08:11<00:39,  7.98s/it] 94%|█████████▍| 63/67 [08:19<00:32,  8.05s/it] 96%|█████████▌| 64/67 [08:27<00:23,  7.96s/it] 97%|█████████▋| 65/67 [08:36<00:16,  8.44s/it] 99%|█████████▊| 66/67 [08:45<00:08,  8.56s/it]100%|██████████| 67/67 [08:49<00:00,  7.05s/it]100%|██████████| 67/67 [08:49<00:00,  7.90s/it]
train_loss=0.3898167272112263
Epoch 2/2
  0%|          | 0/67 [00:00<?, ?it/s]  1%|▏         | 1/67 [00:08<09:31,  8.65s/it]  3%|▎         | 2/67 [00:16<09:07,  8.43s/it]  4%|▍         | 3/67 [00:24<08:45,  8.21s/it]  6%|▌         | 4/67 [00:32<08:24,  8.01s/it]  7%|▋         | 5/67 [00:40<08:21,  8.10s/it]  9%|▉         | 6/67 [00:50<08:51,  8.72s/it] 10%|█         | 7/67 [01:01<09:20,  9.35s/it] 12%|█▏        | 8/67 [01:09<08:44,  8.89s/it] 13%|█▎        | 9/67 [01:16<08:04,  8.36s/it] 15%|█▍        | 10/67 [01:24<07:42,  8.11s/it] 16%|█▋        | 11/67 [01:31<07:24,  7.95s/it] 18%|█▊        | 12/67 [01:38<07:05,  7.74s/it] 19%|█▉        | 13/67 [01:47<07:11,  8.00s/it] 21%|██        | 14/67 [01:54<06:49,  7.73s/it] 22%|██▏       | 15/67 [02:03<07:06,  8.20s/it] 24%|██▍       | 16/67 [02:11<06:55,  8.15s/it] 25%|██▌       | 17/67 [02:19<06:33,  7.88s/it] 27%|██▋       | 18/67 [02:27<06:26,  7.88s/it] 28%|██▊       | 19/67 [02:35<06:28,  8.09s/it] 30%|██▉       | 20/67 [02:44<06:27,  8.24s/it] 31%|███▏      | 21/67 [02:53<06:27,  8.43s/it] 33%|███▎      | 22/67 [03:02<06:31,  8.70s/it] 34%|███▍      | 23/67 [03:10<06:14,  8.51s/it] 36%|███▌      | 24/67 [03:19<06:17,  8.79s/it] 37%|███▋      | 25/67 [03:28<06:02,  8.64s/it] 39%|███▉      | 26/67 [03:35<05:37,  8.23s/it] 40%|████      | 27/67 [03:43<05:22,  8.06s/it] 42%|████▏     | 28/67 [03:49<04:55,  7.59s/it] 43%|████▎     | 29/67 [03:56<04:44,  7.48s/it] 45%|████▍     | 30/67 [04:05<04:44,  7.68s/it] 46%|████▋     | 31/67 [04:11<04:24,  7.35s/it] 48%|████▊     | 32/67 [04:20<04:30,  7.73s/it] 49%|████▉     | 33/67 [04:27<04:19,  7.63s/it] 51%|█████     | 34/67 [04:34<04:09,  7.55s/it] 52%|█████▏    | 35/67 [04:41<03:49,  7.18s/it] 54%|█████▎    | 36/67 [04:49<03:49,  7.41s/it] 55%|█████▌    | 37/67 [04:57<03:49,  7.65s/it] 57%|█████▋    | 38/67 [05:05<03:45,  7.77s/it] 58%|█████▊    | 39/67 [05:13<03:36,  7.72s/it] 60%|█████▉    | 40/67 [05:20<03:28,  7.73s/it] 61%|██████    | 41/67 [05:27<03:15,  7.52s/it] 63%|██████▎   | 42/67 [05:34<03:04,  7.37s/it] 64%|██████▍   | 43/67 [05:43<03:08,  7.86s/it] 66%|██████▌   | 44/67 [05:53<03:10,  8.27s/it] 67%|██████▋   | 45/67 [06:00<02:59,  8.15s/it] 69%|██████▊   | 46/67 [06:07<02:43,  7.78s/it] 70%|███████   | 47/67 [06:16<02:38,  7.94s/it] 72%|███████▏  | 48/67 [06:24<02:33,  8.10s/it] 73%|███████▎  | 49/67 [06:31<02:19,  7.74s/it] 75%|███████▍  | 50/67 [06:39<02:11,  7.72s/it] 76%|███████▌  | 51/67 [06:46<02:01,  7.57s/it] 78%|███████▊  | 52/67 [06:54<01:54,  7.62s/it] 79%|███████▉  | 53/67 [07:02<01:51,  7.95s/it] 81%|████████  | 54/67 [07:10<01:42,  7.88s/it] 82%|████████▏ | 55/67 [07:18<01:32,  7.73s/it] 84%|████████▎ | 56/67 [07:25<01:24,  7.68s/it] 85%|████████▌ | 57/67 [07:34<01:20,  8.06s/it] 87%|████████▋ | 58/67 [07:42<01:12,  8.06s/it] 88%|████████▊ | 59/67 [07:50<01:03,  7.92s/it] 90%|████████▉ | 60/67 [07:58<00:57,  8.17s/it] 91%|█████████ | 61/67 [08:06<00:47,  7.88s/it] 93%|█████████▎| 62/67 [08:14<00:40,  8.06s/it] 94%|█████████▍| 63/67 [08:21<00:30,  7.56s/it] 96%|█████████▌| 64/67 [08:29<00:23,  7.85s/it] 97%|█████████▋| 65/67 [08:37<00:15,  7.74s/it] 99%|█████████▊| 66/67 [08:45<00:07,  7.89s/it]100%|██████████| 67/67 [08:48<00:00,  6.48s/it]100%|██████████| 67/67 [08:48<00:00,  7.89s/it]
train_loss=0.3769964413411582
F1 Score: 0.8370044052863436
P score: 0.7196969696969697
R score: 1.0
Confusion matrix: [[  0 148]
 [  0 380]]
Traceback (most recent call last):
  File "/home/hlp179/nlp/aske/lstm/runscripts/run_lstm.py", line 55, in <module>
    validate(model, val_loader, criterion, device)
  File "/home/hlp179/nlp/aske/lstm/runscripts/../model/lstm.py", line 65, in validate
    return f1
           ^^
NameError: name 'f1' is not defined. Did you mean: 'F1'?
... done <3
