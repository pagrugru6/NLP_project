
=== RUNNING rnn =============

0
training for language fi
Training BPE model for fi, as it doesn't exist, for               vocab size 20000
  0%|          | 0/4252 [00:00<?, ?it/s] 52%|█████▏    | 2201/4252 [00:00<00:00, 12155.79it/s] 80%|████████  | 3417/4252 [00:00<00:00, 6724.21it/s]  98%|█████████▊| 4171/4252 [00:00<00:00, 6024.10it/s]100%|██████████| 4252/4252 [00:00<00:00, 6595.03it/s]
  0%|          | 0/26635 [00:00<?, ?it/s]100%|██████████| 26635/26635 [00:00<00:00, 525190.10it/s]
Model saved to ../checkpoints/bpe/bpe_model_fi_20000.pkl
Epoch 1/2
  0%|          | 0/67 [00:00<?, ?it/s]  1%|▏         | 1/67 [00:08<08:50,  8.04s/it]  3%|▎         | 2/67 [00:17<09:22,  8.66s/it]  4%|▍         | 3/67 [00:26<09:39,  9.05s/it]  6%|▌         | 4/67 [00:35<09:19,  8.88s/it]  7%|▋         | 5/67 [00:43<09:03,  8.76s/it]  9%|▉         | 6/67 [00:51<08:26,  8.30s/it] 10%|█         | 7/67 [00:58<08:05,  8.09s/it] 12%|█▏        | 8/67 [01:06<07:51,  8.00s/it] 13%|█▎        | 9/67 [01:14<07:32,  7.81s/it] 15%|█▍        | 10/67 [01:20<07:06,  7.47s/it] 16%|█▋        | 11/67 [01:29<07:25,  7.96s/it] 18%|█▊        | 12/67 [01:37<07:10,  7.82s/it] 19%|█▉        | 13/67 [01:45<07:01,  7.80s/it] 21%|██        | 14/67 [01:53<07:07,  8.08s/it] 22%|██▏       | 15/67 [02:03<07:18,  8.44s/it] 24%|██▍       | 16/67 [02:10<06:59,  8.23s/it] 25%|██▌       | 17/67 [02:20<07:13,  8.68s/it] 27%|██▋       | 18/67 [02:29<07:02,  8.62s/it] 28%|██▊       | 19/67 [02:38<07:07,  8.91s/it] 30%|██▉       | 20/67 [02:47<06:51,  8.76s/it] 31%|███▏      | 21/67 [02:55<06:34,  8.58s/it] 33%|███▎      | 22/67 [03:03<06:20,  8.46s/it] 34%|███▍      | 23/67 [03:11<06:02,  8.23s/it] 36%|███▌      | 24/67 [03:20<06:06,  8.53s/it] 37%|███▋      | 25/67 [03:28<05:50,  8.34s/it] 39%|███▉      | 26/67 [03:36<05:40,  8.31s/it] 40%|████      | 27/67 [03:43<05:14,  7.85s/it] 42%|████▏     | 28/67 [03:51<05:15,  8.08s/it] 43%|████▎     | 29/67 [04:00<05:18,  8.38s/it] 45%|████▍     | 30/67 [04:09<05:17,  8.59s/it] 46%|████▋     | 31/67 [04:17<04:55,  8.22s/it] 48%|████▊     | 32/67 [04:27<05:05,  8.73s/it] 49%|████▉     | 33/67 [04:34<04:38,  8.19s/it] 51%|█████     | 34/67 [04:41<04:21,  7.92s/it] 52%|█████▏    | 35/67 [04:48<04:08,  7.76s/it] 54%|█████▎    | 36/67 [04:57<04:09,  8.06s/it] 55%|█████▌    | 37/67 [05:05<04:02,  8.09s/it] 57%|█████▋    | 38/67 [05:14<03:56,  8.16s/it] 58%|█████▊    | 39/67 [05:22<03:49,  8.20s/it] 60%|█████▉    | 40/67 [05:31<03:49,  8.49s/it] 61%|██████    | 41/67 [05:39<03:36,  8.33s/it] 63%|██████▎   | 42/67 [05:48<03:30,  8.42s/it] 64%|██████▍   | 43/67 [05:56<03:24,  8.53s/it] 66%|██████▌   | 44/67 [06:04<03:09,  8.25s/it] 67%|██████▋   | 45/67 [06:11<02:55,  7.97s/it] 69%|██████▊   | 46/67 [06:18<02:41,  7.70s/it] 70%|███████   | 47/67 [06:27<02:39,  7.99s/it] 72%|███████▏  | 48/67 [06:36<02:39,  8.39s/it] 73%|███████▎  | 49/67 [06:44<02:24,  8.02s/it] 75%|███████▍  | 50/67 [06:51<02:13,  7.82s/it] 76%|███████▌  | 51/67 [06:59<02:05,  7.85s/it] 78%|███████▊  | 52/67 [07:07<01:57,  7.86s/it] 79%|███████▉  | 53/67 [07:15<01:50,  7.90s/it] 81%|████████  | 54/67 [07:22<01:41,  7.78s/it] 82%|████████▏ | 55/67 [07:30<01:33,  7.79s/it] 84%|████████▎ | 56/67 [07:38<01:26,  7.91s/it] 85%|████████▌ | 57/67 [07:47<01:21,  8.11s/it] 87%|████████▋ | 58/67 [07:55<01:13,  8.12s/it] 88%|████████▊ | 59/67 [08:02<01:02,  7.81s/it] 90%|████████▉ | 60/67 [08:09<00:53,  7.63s/it] 91%|█████████ | 61/67 [08:17<00:46,  7.74s/it] 93%|█████████▎| 62/67 [08:25<00:38,  7.72s/it] 94%|█████████▍| 63/67 [08:33<00:31,  7.91s/it] 96%|█████████▌| 64/67 [08:43<00:25,  8.42s/it] 97%|█████████▋| 65/67 [08:51<00:16,  8.40s/it] 99%|█████████▊| 66/67 [09:01<00:08,  8.85s/it]100%|██████████| 67/67 [09:04<00:00,  6.98s/it]100%|██████████| 67/67 [09:04<00:00,  8.12s/it]
train_loss=0.392468601910036
Epoch 2/2
  0%|          | 0/67 [00:00<?, ?it/s]  1%|▏         | 1/67 [00:09<10:28,  9.52s/it]  3%|▎         | 2/67 [00:17<09:32,  8.81s/it]  4%|▍         | 3/67 [00:25<08:50,  8.28s/it]  6%|▌         | 4/67 [00:32<08:21,  7.96s/it]  7%|▋         | 5/67 [00:40<08:11,  7.93s/it]  9%|▉         | 6/67 [00:49<08:17,  8.16s/it] 10%|█         | 7/67 [00:58<08:22,  8.37s/it] 12%|█▏        | 8/67 [01:06<08:05,  8.24s/it] 13%|█▎        | 9/67 [01:14<08:01,  8.30s/it] 15%|█▍        | 10/67 [01:22<07:48,  8.22s/it] 16%|█▋        | 11/67 [01:31<07:45,  8.30s/it] 18%|█▊        | 12/67 [01:40<07:53,  8.60s/it] 19%|█▉        | 13/67 [01:49<07:49,  8.70s/it] 21%|██        | 14/67 [01:58<07:41,  8.70s/it] 22%|██▏       | 15/67 [02:06<07:21,  8.50s/it] 24%|██▍       | 16/67 [02:14<07:17,  8.58s/it] 25%|██▌       | 17/67 [02:22<06:52,  8.25s/it] 27%|██▋       | 18/67 [02:30<06:43,  8.23s/it] 28%|██▊       | 19/67 [02:38<06:36,  8.27s/it] 30%|██▉       | 20/67 [02:46<06:23,  8.15s/it] 31%|███▏      | 21/67 [02:56<06:29,  8.48s/it] 33%|███▎      | 22/67 [03:03<06:04,  8.10s/it] 34%|███▍      | 23/67 [03:10<05:43,  7.80s/it] 36%|███▌      | 24/67 [03:18<05:33,  7.76s/it] 37%|███▋      | 25/67 [03:26<05:30,  7.87s/it] 39%|███▉      | 26/67 [03:33<05:16,  7.71s/it] 40%|████      | 27/67 [03:42<05:22,  8.06s/it] 42%|████▏     | 28/67 [03:49<05:04,  7.82s/it] 43%|████▎     | 29/67 [03:58<05:04,  8.00s/it] 45%|████▍     | 30/67 [04:07<05:08,  8.34s/it] 46%|████▋     | 31/67 [04:15<05:02,  8.41s/it] 48%|████▊     | 32/67 [04:22<04:40,  8.01s/it] 49%|████▉     | 33/67 [04:32<04:50,  8.54s/it] 51%|█████     | 34/67 [04:41<04:44,  8.63s/it] 52%|█████▏    | 35/67 [04:50<04:36,  8.63s/it] 54%|█████▎    | 36/67 [04:58<04:28,  8.67s/it] 55%|█████▌    | 37/67 [05:07<04:16,  8.55s/it] 57%|█████▋    | 38/67 [05:15<04:05,  8.47s/it] 58%|█████▊    | 39/67 [05:24<03:59,  8.55s/it] 60%|█████▉    | 40/67 [05:32<03:49,  8.49s/it] 61%|██████    | 41/67 [05:40<03:36,  8.33s/it] 63%|██████▎   | 42/67 [05:48<03:24,  8.18s/it] 64%|██████▍   | 43/67 [05:55<03:12,  8.01s/it] 66%|██████▌   | 44/67 [06:03<03:00,  7.85s/it] 67%|██████▋   | 45/67 [06:11<02:54,  7.92s/it] 69%|██████▊   | 46/67 [06:18<02:43,  7.80s/it] 70%|███████   | 47/67 [06:27<02:39,  7.99s/it] 72%|███████▏  | 48/67 [06:36<02:39,  8.41s/it] 73%|███████▎  | 49/67 [06:44<02:27,  8.19s/it] 75%|███████▍  | 50/67 [06:53<02:22,  8.38s/it] 76%|███████▌  | 51/67 [07:00<02:10,  8.15s/it] 78%|███████▊  | 52/67 [07:08<02:01,  8.13s/it] 79%|███████▉  | 53/67 [07:17<01:54,  8.16s/it] 81%|████████  | 54/67 [07:26<01:49,  8.42s/it] 82%|████████▏ | 55/67 [07:32<01:33,  7.82s/it] 84%|████████▎ | 56/67 [07:39<01:22,  7.54s/it] 85%|████████▌ | 57/67 [07:49<01:22,  8.20s/it] 87%|████████▋ | 58/67 [07:57<01:13,  8.14s/it] 88%|████████▊ | 59/67 [08:04<01:03,  7.93s/it] 90%|████████▉ | 60/67 [08:12<00:54,  7.75s/it] 91%|█████████ | 61/67 [08:20<00:47,  7.89s/it] 93%|█████████▎| 62/67 [08:29<00:41,  8.22s/it] 94%|█████████▍| 63/67 [08:35<00:30,  7.72s/it] 96%|█████████▌| 64/67 [08:43<00:23,  7.71s/it] 97%|█████████▋| 65/67 [08:52<00:15,  7.97s/it] 99%|█████████▊| 66/67 [08:59<00:07,  7.80s/it]100%|██████████| 67/67 [09:03<00:00,  6.65s/it]100%|██████████| 67/67 [09:03<00:00,  8.11s/it]
train_loss=0.37955463232833947
Traceback (most recent call last):
  File "/home/hlp179/nlp/aske/lstm/runscripts/run_lstm.py", line 55, in <module>
    validate(model, val_loader, criterion, device)
  File "/home/hlp179/nlp/aske/lstm/runscripts/../model/lstm.py", line 60, in validate
    P, R, F1 = precision_recall_fscore_supper(true_labels, predictions, average='binary')
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'precision_recall_fscore_supper' is not defined. Did you mean: 'precision_recall_fscore_support'?
... done <3
