
=== RUNNING rnn =============

0
training for language fi
Training BPE model for fi, as it doesn't exist, for               vocab size 1000
  0%|          | 0/4252 [00:00<?, ?it/s] 55%|█████▌    | 2351/4252 [00:00<00:00, 23503.52it/s]100%|██████████| 4252/4252 [00:00<00:00, 7736.80it/s] 
  0%|          | 0/26635 [00:00<?, ?it/s]100%|██████████| 26635/26635 [00:00<00:00, 558406.12it/s]
Model saved to ../checkpoints/bpe/bpe_model_fi_1000.pkl
Generating vocab
  0%|          | 0/4252 [00:00<?, ?it/s]  2%|▏         | 86/4252 [00:00<00:04, 842.83it/s]  4%|▍         | 172/4252 [00:00<00:04, 851.36it/s]  6%|▌         | 263/4252 [00:00<00:04, 877.64it/s]  8%|▊         | 361/4252 [00:00<00:04, 916.53it/s] 11%|█         | 461/4252 [00:00<00:04, 945.59it/s] 13%|█▎        | 565/4252 [00:00<00:03, 974.56it/s] 16%|█▌        | 665/4252 [00:00<00:03, 981.03it/s] 18%|█▊        | 768/4252 [00:00<00:03, 996.55it/s] 21%|██        | 875/4252 [00:00<00:03, 1019.27it/s] 23%|██▎       | 979/4252 [00:01<00:03, 1024.28it/s] 25%|██▌       | 1082/4252 [00:01<00:03, 1022.54it/s] 28%|██▊       | 1185/4252 [00:01<00:03, 1011.68it/s] 31%|███       | 1298/4252 [00:01<00:02, 1046.92it/s] 33%|███▎      | 1405/4252 [00:01<00:02, 1051.69it/s] 36%|███▌      | 1512/4252 [00:01<00:02, 1053.91it/s] 38%|███▊      | 1618/4252 [00:01<00:02, 1042.04it/s] 41%|████      | 1723/4252 [00:01<00:02, 1022.04it/s] 43%|████▎     | 1836/4252 [00:01<00:02, 1051.05it/s] 46%|████▌     | 1946/4252 [00:01<00:02, 1062.56it/s] 48%|████▊     | 2061/4252 [00:02<00:02, 1087.39it/s] 51%|█████     | 2170/4252 [00:02<00:05, 369.53it/s]  53%|█████▎    | 2251/4252 [00:04<00:11, 172.08it/s] 54%|█████▍    | 2310/4252 [00:04<00:14, 136.76it/s] 55%|█████▌    | 2354/4252 [00:05<00:17, 107.94it/s] 56%|█████▌    | 2386/4252 [00:06<00:18, 101.67it/s] 57%|█████▋    | 2411/4252 [00:06<00:20, 89.31it/s]  57%|█████▋    | 2430/4252 [00:06<00:21, 86.47it/s] 58%|█████▊    | 2446/4252 [00:07<00:22, 80.68it/s] 58%|█████▊    | 2459/4252 [00:07<00:22, 78.92it/s] 58%|█████▊    | 2470/4252 [00:07<00:22, 80.88it/s] 58%|█████▊    | 2481/4252 [00:07<00:21, 83.33it/s] 59%|█████▊    | 2492/4252 [00:07<00:23, 75.96it/s] 59%|█████▉    | 2501/4252 [00:07<00:25, 70.03it/s] 59%|█████▉    | 2514/4252 [00:07<00:22, 78.28it/s] 59%|█████▉    | 2524/4252 [00:08<00:21, 80.41it/s] 60%|█████▉    | 2533/4252 [00:08<00:23, 73.93it/s] 60%|█████▉    | 2542/4252 [00:08<00:22, 76.98it/s] 60%|█████▉    | 2551/4252 [00:08<00:22, 74.38it/s] 60%|██████    | 2559/4252 [00:08<00:24, 70.16it/s] 60%|██████    | 2567/4252 [00:08<00:23, 71.36it/s] 61%|██████    | 2575/4252 [00:08<00:24, 67.75it/s] 61%|██████    | 2582/4252 [00:08<00:25, 66.45it/s] 61%|██████    | 2589/4252 [00:09<00:25, 64.60it/s] 61%|██████    | 2596/4252 [00:09<00:28, 57.95it/s] 61%|██████    | 2604/4252 [00:09<00:26, 61.87it/s] 61%|██████▏   | 2613/4252 [00:09<00:23, 68.42it/s] 62%|██████▏   | 2621/4252 [00:09<00:27, 60.33it/s] 62%|██████▏   | 2628/4252 [00:09<00:26, 61.01it/s] 62%|██████▏   | 2637/4252 [00:09<00:24, 67.14it/s] 62%|██████▏   | 2644/4252 [00:09<00:23, 67.43it/s] 62%|██████▏   | 2651/4252 [00:10<00:27, 58.40it/s] 63%|██████▎   | 2659/4252 [00:10<00:25, 62.57it/s] 63%|██████▎   | 2666/4252 [00:10<00:28, 56.53it/s] 63%|██████▎   | 2674/4252 [00:10<00:25, 61.17it/s] 63%|██████▎   | 2681/4252 [00:10<00:24, 63.33it/s] 63%|██████▎   | 2689/4252 [00:10<00:23, 66.21it/s] 63%|██████▎   | 2696/4252 [00:10<00:24, 63.79it/s] 64%|██████▎   | 2703/4252 [00:10<00:24, 62.11it/s] 64%|██████▎   | 2710/4252 [00:11<00:29, 52.96it/s] 64%|██████▍   | 2718/4252 [00:11<00:27, 55.48it/s] 64%|██████▍   | 2724/4252 [00:11<00:27, 55.74it/s] 64%|██████▍   | 2732/4252 [00:11<00:24, 61.25it/s] 64%|██████▍   | 2741/4252 [00:11<00:22, 68.20it/s] 65%|██████▍   | 2751/4252 [00:11<00:20, 71.95it/s] 65%|██████▍   | 2762/4252 [00:11<00:19, 77.63it/s] 65%|██████▌   | 2772/4252 [00:11<00:17, 82.59it/s] 65%|██████▌   | 2782/4252 [00:12<00:17, 84.44it/s] 66%|██████▌   | 2791/4252 [00:12<00:18, 80.92it/s] 66%|██████▌   | 2800/4252 [00:12<00:18, 78.11it/s] 66%|██████▌   | 2809/4252 [00:12<00:18, 79.95it/s] 66%|██████▋   | 2818/4252 [00:12<00:19, 72.51it/s] 66%|██████▋   | 2826/4252 [00:12<00:19, 71.72it/s] 67%|██████▋   | 2834/4252 [00:12<00:20, 68.56it/s] 67%|██████▋   | 2842/4252 [00:12<00:20, 70.25it/s] 67%|██████▋   | 2850/4252 [00:13<00:21, 64.05it/s] 67%|██████▋   | 2858/4252 [00:13<00:20, 66.79it/s] 67%|██████▋   | 2866/4252 [00:13<00:19, 70.10it/s] 68%|██████▊   | 2874/4252 [00:13<00:19, 71.24it/s] 68%|██████▊   | 2882/4252 [00:13<00:19, 71.39it/s] 68%|██████▊   | 2890/4252 [00:13<00:23, 59.16it/s] 68%|██████▊   | 2897/4252 [00:13<00:22, 61.58it/s] 68%|██████▊   | 2904/4252 [00:13<00:23, 57.48it/s] 68%|██████▊   | 2911/4252 [00:13<00:22, 58.74it/s] 69%|██████▊   | 2919/4252 [00:14<00:21, 62.07it/s] 69%|██████▉   | 2926/4252 [00:14<00:21, 62.02it/s] 69%|██████▉   | 2933/4252 [00:14<00:21, 62.03it/s] 69%|██████▉   | 2940/4252 [00:14<00:21, 62.04it/s] 69%|██████▉   | 2947/4252 [00:14<00:23, 56.70it/s] 69%|██████▉   | 2953/4252 [00:14<00:29, 44.72it/s] 70%|██████▉   | 2961/4252 [00:14<00:25, 51.56it/s] 70%|██████▉   | 2968/4252 [00:15<00:23, 55.74it/s] 70%|██████▉   | 2975/4252 [00:15<00:21, 58.70it/s] 70%|███████   | 2984/4252 [00:15<00:19, 66.48it/s] 70%|███████   | 2991/4252 [00:15<00:19, 65.56it/s] 71%|███████   | 2998/4252 [00:15<00:20, 61.24it/s] 71%|███████   | 3007/4252 [00:15<00:18, 65.72it/s] 71%|███████   | 3014/4252 [00:15<00:18, 66.39it/s] 71%|███████   | 3025/4252 [00:15<00:16, 76.60it/s] 71%|███████▏  | 3033/4252 [00:15<00:18, 65.28it/s] 71%|███████▏  | 3040/4252 [00:16<00:18, 65.83it/s] 72%|███████▏  | 3049/4252 [00:16<00:17, 70.63it/s] 72%|███████▏  | 3059/4252 [00:16<00:15, 75.73it/s] 72%|███████▏  | 3067/4252 [00:16<00:15, 75.14it/s] 72%|███████▏  | 3075/4252 [00:16<00:15, 75.90it/s] 73%|███████▎  | 3087/4252 [00:16<00:13, 88.09it/s] 73%|███████▎  | 3096/4252 [00:16<00:14, 82.44it/s] 73%|███████▎  | 3105/4252 [00:16<00:14, 80.07it/s] 73%|███████▎  | 3114/4252 [00:16<00:15, 74.31it/s] 73%|███████▎  | 3123/4252 [00:17<00:15, 74.81it/s] 74%|███████▎  | 3134/4252 [00:17<00:13, 83.24it/s] 74%|███████▍  | 3143/4252 [00:17<00:14, 74.63it/s] 74%|███████▍  | 3151/4252 [00:17<00:15, 71.77it/s] 74%|███████▍  | 3159/4252 [00:17<00:15, 71.06it/s] 74%|███████▍  | 3167/4252 [00:17<00:18, 59.90it/s] 75%|███████▍  | 3175/4252 [00:17<00:16, 64.42it/s] 75%|███████▍  | 3186/4252 [00:18<00:14, 72.76it/s] 75%|███████▌  | 3194/4252 [00:18<00:15, 67.81it/s] 75%|███████▌  | 3202/4252 [00:18<00:15, 68.16it/s] 75%|███████▌  | 3210/4252 [00:18<00:15, 69.26it/s] 76%|███████▌  | 3219/4252 [00:18<00:13, 74.12it/s] 76%|███████▌  | 3229/4252 [00:18<00:13, 78.43it/s] 76%|███████▌  | 3237/4252 [00:18<00:16, 62.95it/s] 76%|███████▋  | 3244/4252 [00:18<00:15, 63.48it/s] 76%|███████▋  | 3251/4252 [00:18<00:15, 64.17it/s] 77%|███████▋  | 3258/4252 [00:19<00:17, 55.31it/s] 77%|███████▋  | 3266/4252 [00:19<00:16, 60.51it/s] 77%|███████▋  | 3275/4252 [00:19<00:14, 67.46it/s] 77%|███████▋  | 3283/4252 [00:19<00:14, 64.71it/s] 77%|███████▋  | 3292/4252 [00:19<00:13, 69.49it/s] 78%|███████▊  | 3300/4252 [00:19<00:15, 61.90it/s] 78%|███████▊  | 3308/4252 [00:19<00:14, 64.59it/s] 78%|███████▊  | 3316/4252 [00:20<00:13, 67.05it/s] 78%|███████▊  | 3324/4252 [00:20<00:13, 70.05it/s] 78%|███████▊  | 3334/4252 [00:20<00:11, 77.91it/s] 79%|███████▊  | 3342/4252 [00:20<00:12, 75.52it/s] 79%|███████▉  | 3350/4252 [00:20<00:12, 74.32it/s] 79%|███████▉  | 3360/4252 [00:20<00:11, 81.04it/s] 79%|███████▉  | 3369/4252 [00:20<00:12, 69.30it/s] 79%|███████▉  | 3377/4252 [00:20<00:13, 66.82it/s] 80%|███████▉  | 3385/4252 [00:20<00:12, 66.70it/s] 80%|███████▉  | 3393/4252 [00:21<00:12, 69.71it/s] 80%|███████▉  | 3401/4252 [00:21<00:13, 61.01it/s] 80%|████████  | 3409/4252 [00:21<00:13, 64.31it/s] 80%|████████  | 3416/4252 [00:21<00:13, 62.95it/s] 81%|████████  | 3426/4252 [00:21<00:12, 68.34it/s] 81%|████████  | 3434/4252 [00:21<00:11, 70.25it/s] 81%|████████  | 3442/4252 [00:21<00:11, 68.07it/s] 81%|████████  | 3451/4252 [00:21<00:11, 72.40it/s] 81%|████████▏ | 3459/4252 [00:22<00:10, 72.89it/s] 82%|████████▏ | 3468/4252 [00:22<00:10, 76.94it/s] 82%|████████▏ | 3476/4252 [00:22<00:10, 70.93it/s] 82%|████████▏ | 3484/4252 [00:22<00:10, 72.77it/s] 82%|████████▏ | 3492/4252 [00:22<00:10, 72.80it/s] 82%|████████▏ | 3500/4252 [00:22<00:10, 70.30it/s] 83%|████████▎ | 3508/4252 [00:22<00:12, 61.00it/s] 83%|████████▎ | 3516/4252 [00:22<00:11, 63.56it/s] 83%|████████▎ | 3524/4252 [00:22<00:10, 66.82it/s] 83%|████████▎ | 3532/4252 [00:23<00:10, 67.73it/s] 83%|████████▎ | 3540/4252 [00:23<00:10, 69.36it/s] 83%|████████▎ | 3548/4252 [00:23<00:10, 68.40it/s] 84%|████████▎ | 3555/4252 [00:23<00:11, 60.15it/s] 84%|████████▍ | 3563/4252 [00:23<00:10, 64.33it/s] 84%|████████▍ | 3570/4252 [00:23<00:10, 62.06it/s] 84%|████████▍ | 3577/4252 [00:23<00:10, 62.98it/s] 84%|████████▍ | 3587/4252 [00:23<00:09, 72.75it/s] 85%|████████▍ | 3595/4252 [00:24<00:09, 68.73it/s] 85%|████████▍ | 3604/4252 [00:24<00:09, 67.22it/s] 85%|████████▍ | 3613/4252 [00:24<00:08, 71.21it/s] 85%|████████▌ | 3621/4252 [00:24<00:08, 71.02it/s] 85%|████████▌ | 3630/4252 [00:24<00:08, 74.04it/s] 86%|████████▌ | 3639/4252 [00:24<00:08, 76.37it/s] 86%|████████▌ | 3647/4252 [00:24<00:09, 65.79it/s] 86%|████████▌ | 3655/4252 [00:24<00:08, 67.39it/s] 86%|████████▌ | 3663/4252 [00:25<00:08, 69.31it/s] 86%|████████▋ | 3671/4252 [00:25<00:08, 70.09it/s] 87%|████████▋ | 3679/4252 [00:25<00:08, 68.32it/s] 87%|████████▋ | 3687/4252 [00:25<00:08, 69.28it/s] 87%|████████▋ | 3699/4252 [00:25<00:06, 79.09it/s] 87%|████████▋ | 3709/4252 [00:25<00:06, 84.11it/s] 87%|████████▋ | 3718/4252 [00:25<00:06, 84.51it/s] 88%|████████▊ | 3727/4252 [00:25<00:06, 79.20it/s] 88%|████████▊ | 3736/4252 [00:25<00:07, 68.90it/s] 88%|████████▊ | 3748/4252 [00:26<00:06, 77.59it/s] 88%|████████▊ | 3757/4252 [00:26<00:07, 67.54it/s] 89%|████████▊ | 3765/4252 [00:26<00:07, 67.37it/s] 89%|████████▉ | 3774/4252 [00:26<00:06, 71.72it/s] 89%|████████▉ | 3783/4252 [00:26<00:06, 71.65it/s] 89%|████████▉ | 3791/4252 [00:26<00:06, 66.22it/s] 89%|████████▉ | 3800/4252 [00:26<00:06, 69.19it/s] 90%|████████▉ | 3810/4252 [00:27<00:05, 75.03it/s] 90%|████████▉ | 3818/4252 [00:27<00:05, 75.71it/s] 90%|████████▉ | 3826/4252 [00:27<00:05, 73.87it/s] 90%|█████████ | 3834/4252 [00:27<00:05, 72.82it/s] 90%|█████████ | 3842/4252 [00:27<00:05, 70.83it/s] 91%|█████████ | 3850/4252 [00:27<00:06, 65.92it/s] 91%|█████████ | 3858/4252 [00:27<00:05, 69.23it/s] 91%|█████████ | 3867/4252 [00:27<00:05, 70.72it/s] 91%|█████████ | 3875/4252 [00:27<00:05, 68.97it/s] 91%|█████████▏| 3884/4252 [00:28<00:05, 73.14it/s] 92%|█████████▏| 3893/4252 [00:28<00:04, 76.84it/s] 92%|█████████▏| 3901/4252 [00:28<00:04, 75.54it/s] 92%|█████████▏| 3910/4252 [00:28<00:04, 79.25it/s] 92%|█████████▏| 3918/4252 [00:28<00:04, 76.28it/s] 92%|█████████▏| 3926/4252 [00:28<00:04, 75.30it/s] 93%|█████████▎| 3934/4252 [00:28<00:04, 74.38it/s] 93%|█████████▎| 3943/4252 [00:28<00:04, 76.56it/s] 93%|█████████▎| 3951/4252 [00:28<00:04, 74.59it/s] 93%|█████████▎| 3959/4252 [00:29<00:04, 71.07it/s] 93%|█████████▎| 3967/4252 [00:29<00:04, 69.27it/s] 93%|█████████▎| 3975/4252 [00:29<00:03, 71.99it/s] 94%|█████████▎| 3983/4252 [00:29<00:03, 68.24it/s] 94%|█████████▍| 3993/4252 [00:29<00:03, 73.37it/s] 94%|█████████▍| 4001/4252 [00:29<00:03, 71.47it/s] 94%|█████████▍| 4009/4252 [00:29<00:03, 67.69it/s] 94%|█████████▍| 4018/4252 [00:29<00:03, 72.48it/s] 95%|█████████▍| 4029/4252 [00:30<00:02, 82.19it/s] 95%|█████████▌| 4040/4252 [00:30<00:02, 89.14it/s] 95%|█████████▌| 4050/4252 [00:30<00:02, 84.50it/s] 96%|█████████▌| 4061/4252 [00:30<00:02, 87.56it/s] 96%|█████████▌| 4070/4252 [00:30<00:02, 80.66it/s] 96%|█████████▌| 4081/4252 [00:30<00:02, 85.18it/s] 96%|█████████▌| 4090/4252 [00:30<00:02, 77.50it/s] 96%|█████████▋| 4098/4252 [00:30<00:02, 74.45it/s] 97%|█████████▋| 4107/4252 [00:30<00:01, 78.07it/s] 97%|█████████▋| 4117/4252 [00:31<00:01, 83.60it/s] 97%|█████████▋| 4128/4252 [00:31<00:01, 89.06it/s] 97%|█████████▋| 4138/4252 [00:31<00:01, 88.91it/s] 98%|█████████▊| 4153/4252 [00:31<00:00, 105.23it/s] 98%|█████████▊| 4164/4252 [00:31<00:00, 96.09it/s]  98%|█████████▊| 4177/4252 [00:31<00:00, 102.29it/s] 98%|█████████▊| 4188/4252 [00:31<00:00, 89.28it/s]  99%|█████████▊| 4198/4252 [00:31<00:00, 89.34it/s] 99%|█████████▉| 4208/4252 [00:32<00:00, 75.97it/s] 99%|█████████▉| 4217/4252 [00:32<00:00, 65.45it/s] 99%|█████████▉| 4225/4252 [00:32<00:00, 62.26it/s]100%|█████████▉| 4232/4252 [00:32<00:00, 60.07it/s]100%|█████████▉| 4239/4252 [00:32<00:00, 57.12it/s]100%|█████████▉| 4245/4252 [00:32<00:00, 56.16it/s]100%|█████████▉| 4251/4252 [00:32<00:00, 57.07it/s]100%|██████████| 4252/4252 [00:32<00:00, 129.07it/s]
Epoch 1/2
1
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:00<?, ?it/s]
label=True
label=True, int(label)=1, torch.tensor(int(label))=tensor(1)
Traceback (most recent call last):
  File "/home/hlp179/nlp/aske/lstm/runscripts/run_lstm.py", line 50, in <module>
    train_loss = train(model, train_loader, criterion, optimizer, device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hlp179/nlp/aske/lstm/runscripts/../model/lstm.py", line 35, in train
    logits = model(context, question, word_overlap)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hlp179/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hlp179/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hlp179/nlp/aske/lstm/runscripts/../model/lstm.py", line 13, in forward
    context_embedded = self.embedding(context)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hlp179/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hlp179/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hlp179/.local/lib/python3.12/site-packages/torch/nn/modules/sparse.py", line 164, in forward
    return F.embedding(
           ^^^^^^^^^^^^
  File "/home/hlp179/.local/lib/python3.12/site-packages/torch/nn/functional.py", line 2267, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
... done <3
